(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{27:function(e,t,n){},35:function(e,t,n){},36:function(e,t,n){},37:function(e,t,n){},38:function(e,t,n){"use strict";n.r(t);var s=n(0),r=n.n(s),a=n(19),c=n.n(a),o=(n(27),n(10)),i=n(2),l=n(17),u=n(22),j=n(7),b=n.n(j),h=n(12),d=n(9),p=n(13),m=n(1),O=Object(s.createContext)(),f=O,x=function(e){var t=e.children,n=Object(s.useState)((function(){return localStorage.getItem("authTokens")?JSON.parse(localStorage.getItem("authTokens")):null})),r=Object(d.a)(n,2),a=r[0],c=r[1],o=Object(s.useState)((function(){return localStorage.getItem("authTokens")?Object(p.a)(localStorage.getItem("authTokens")):null})),l=Object(d.a)(o,2),u=l[0],j=l[1],f=Object(s.useState)(!0),x=Object(d.a)(f,2),g=x[0],v=x[1],N=Object(s.useState)(!1),S=Object(d.a)(N,2),y=S[0],k=S[1],w=Object(i.f)(),I=function(){var e=Object(h.a)(b.a.mark((function e(t){var n,s;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,fetch("http://127.0.0.1:8000/api/token/",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({username:t.target.username.value,password:t.target.password.value})});case 3:return n=e.sent,e.next=6,n.json();case 6:s=e.sent,200===n.status?(c(s),j(Object(p.a)(s.access)),localStorage.setItem("authTokens",JSON.stringify(s)),k(!1),w.push("/")):k(!0);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),T=function(){c(null),j(null),localStorage.removeItem("authTokens"),w.push("/login")},C=function(){var e=Object(h.a)(b.a.mark((function e(){var t,n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("http://127.0.0.1:8000/api/token/refresh/",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({refresh:null===a||void 0===a?void 0:a.refresh})});case 2:return t=e.sent,e.next=5,t.json();case 5:n=e.sent,200===t.status?(c(n),j(Object(p.a)(n.access)),localStorage.setItem("authTokens",JSON.stringify(n))):T(),g&&v(!1);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),E={user:u,authTokens:a,logInError:y,logInUser:I,logOutUser:T};return Object(s.useEffect)((function(){if(g&&a?C():v(!1),a){var e=setInterval((function(){C()}),24e4);return function(){return clearInterval(e)}}}),[a,g]),Object(m.jsx)(O.Provider,{value:E,children:g?null:t})},g=["children"],v=function(e){var t=e.children,n=Object(u.a)(e,g),r=Object(s.useContext)(f).user;return Object(m.jsx)(i.b,Object(l.a)(Object(l.a)({},n),{},{children:r?t:Object(m.jsx)(i.a,{to:"/login"})}))},N=(n(35),function(){var e=Object(s.useContext)(f),t=e.user,n=e.logOutUser;return Object(m.jsxs)("div",{className:"container-fluid header",children:[Object(m.jsx)("p",{className:"logo",children:"Access and Refresh Tokens"}),t&&Object(m.jsxs)("p",{className:"user-message",children:["Hello, ",Object(m.jsx)("span",{className:"username",children:t.username})]}),Object(m.jsx)(o.b,{className:"btn btn-primary home-btn",to:"/",children:"Home"}),t&&Object(m.jsx)("button",{className:"btn btn-primary logout-btn",onClick:n,children:"Log out"})]})}),S=(n(36),function(){var e=Object(s.useState)([]),t=Object(d.a)(e,2),n=t[0],r=t[1],a=Object(s.useContext)(f),c=a.authTokens,o=a.logOutUser,i=function(){var e=Object(h.a)(b.a.mark((function e(){var t,n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("http://127.0.0.1:8000/api/notes/",{method:"GET",headers:{"Content-type":"application/json",Authorization:"Bearer "+String(c.access)}});case 2:return t=e.sent,e.next=5,t.json();case 5:n=e.sent,200===t.status?r(n):401===t.status&&o();case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(s.useEffect)((function(){i()}),[]),Object(m.jsxs)("div",{className:"container home-container",children:[Object(m.jsx)("p",{className:"home-message",children:"You are logged to the home page"}),Object(m.jsx)("ul",{className:"list-group",children:n.map((function(e){return Object(m.jsx)("li",{className:"list-group-item",children:e.body},e.id)}))}),Object(m.jsx)("p",{className:"home-message",children:"Tokens"}),Object(m.jsxs)("ul",{className:"list-group",children:[Object(m.jsxs)("li",{className:"list-group-item",children:["Access: ",Object(m.jsx)("span",{children:c.access})]}),Object(m.jsxs)("li",{className:"list-group-item",children:["Refresh: ",Object(m.jsx)("span",{children:c.refresh})]})]})]})}),y=(n(37),function(){var e=Object(s.useContext)(f),t=e.logInError,n=e.logInUser;return Object(m.jsxs)("div",{className:"container",children:[t&&Object(m.jsx)("p",{className:"login-error",children:"Invalid username or password"}),Object(m.jsxs)("form",{onSubmit:n,children:[Object(m.jsxs)("div",{className:"form-group",children:[Object(m.jsx)("label",{for:"username",children:"Username"}),Object(m.jsx)("input",{type:"text",name:"username",className:"form-control",id:"username",placeholder:"Enter Username"})]}),Object(m.jsxs)("div",{className:"form-group",children:[Object(m.jsx)("label",{for:"userpass",children:"Password"}),Object(m.jsx)("input",{type:"password",name:"password",className:"form-control",id:"userpass",placeholder:"Password"})]}),Object(m.jsx)("div",{className:"btn-container",children:Object(m.jsx)("button",{type:"submit",className:"btn btn-primary",children:"Log in"})})]})]})});var k=function(){return Object(m.jsx)("div",{className:"App",children:Object(m.jsx)(o.a,{children:Object(m.jsxs)(x,{children:[Object(m.jsx)(N,{}),Object(m.jsx)(v,{exact:!0,path:"/",component:S}),Object(m.jsx)(i.b,{path:"/login",component:y})]})})})};c.a.render(Object(m.jsx)(r.a.StrictMode,{children:Object(m.jsx)(k,{})}),document.getElementById("root"))}},[[38,1,2]]]);
//# sourceMappingURL=main.37970ca8.chunk.js.map